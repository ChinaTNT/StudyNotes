<html>
<head>
  <title>SQL必知必会实践--mysql</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600667 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="513"/>
<h1>SQL必知必会实践--mysql</h1>

<div>
<span><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">mysql安装</span></div><div>--</div><div><br/></div><div><a href="https://www.mysql.com/downloads/">https://www.mysql.com/downloads/</a></div><div><img src="SQL必知必会实践--mysql_files/Image.png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>终端执行命令</div><div><img src="SQL必知必会实践--mysql_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>（可参考本笔记<span style="font-weight: bold;">MySQL环境搭建-mysql 8.0.13 解压版安装配置方法图文教程</span>）</div><div><br/></div><div>mysql 教学demo --命令行输指令创建表</div><div><a href="http://www.forta.com/books/0672336073/">http://www.forta.com/books/0672336073/</a></div><div><img src="SQL必知必会实践--mysql_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>数据库tysql关系图</div><div><img src="SQL必知必会实践--mysql_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><hr/><div><br/></div></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">概念</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><br/></div><div>数据库：保存有组织数据的容器</div><div>数据库软件：也作DBMS，数据库是通过DBMS来创建和操纵的容器。</div><div>表table：某种特定类型的结构化清单。数据库中的每个表都有唯一的名字来标识自己，称之为表名。</div><div>模式schema：用来描述关于数据库和表的布局及特性的信息。</div><div>表的列column：表中的一个字段，所有表都是由一个或多个列组成的。</div><div>行row：表中的一条记录。record</div><div>主键primary key：一列或几列，其值能够唯一标识表中的每一行。<span style="color: rgb(255, 70, 53);">不能重用，不允许修改和更新，即使某行从表中删除，他的主键也不能赋给以后的新行。</span></div><div>数据类型datatype：所允许的数据的类型，每个表列都有相应的数据类型，它限制该列中存储的数据。</div><div><br/></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">ch2 检索数据</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><br/></div><div><span style="font-weight: bold;">查询</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>SELECT 列1， 列2 FROM 表；</div></div><div><br/></div><div>一般习惯：关键是大写，列名和表名使用小写。</div><div><span style="color: rgb(255, 70, 53);">所有空格都被忽略。即SQL可以写一行也可以多行。不区分大小写，不论关键字还是表名列名。</span></div><div><img src="SQL必知必会实践--mysql_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div><img src="SQL必知必会实践--mysql_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div><img src="SQL必知必会实践--mysql_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>SELECT <font color="#FF4635">DISTINCT</font> vend_id FROM Products; --仅显示不同项，DISTINICT必须放在列名的前面,否则无效（不会报错，仅DISTINICT不生效，SELECT正常执行）</div></div><div><img src="SQL必知必会实践--mysql_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div><img src="SQL必知必会实践--mysql_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">SELECT DISTINCT vend_id FROM Products LIMIT 2; --限制仅输出查询的两行，不同数据库软件对于指令略有不同</span></div></div><div><img src="SQL必知必会实践--mysql_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">SELECT prod_id FROM Products LIMIT 3 OFFSET 1;--从OFFSET开始查询最多3行，OFFSET为起点坐标（从0开始计数）</span></div></div><div><img src="SQL必知必会实践--mysql_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div><img src="SQL必知必会实践--mysql_files/Image [11].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><span style="font-weight: bold;">注释</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>-- 注释内容 两个连字符和注释之间有至少一个空格符，否则语法错误</div></div><div><img src="SQL必知必会实践--mysql_files/Image [12].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>#注释内容，没有空格要求</div></div><div><img src="SQL必知必会实践--mysql_files/Image [13].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>/*注释内容*/ 可以进行多行注释，没有空格要求</div></div><div><img src="SQL必知必会实践--mysql_files/Image [14].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">ch3  排序检索数据</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">SELECT prod_name FROM Products</span> <span style="font-family: Monaco; font-size: 9pt;"><font color="#FF0000">ORDER BY prod_price</font></span><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">; -- 按物品价格排序，默认从低到高，必须是SELECT中最后一条语句，否则报错。</span></div></div><div><img src="SQL必知必会实践--mysql_files/Image [15].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>SELECT prod_name,prod_price FROM Products <font color="#FF4635">ORDER BY prod_price,prod_name</font>; --先按价钱再按名称排列（分两次排列）</div></div><div><img src="SQL必知必会实践--mysql_files/Image [16].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>SELECT vend_id,prod_name,prod_price FROM Products ORDER BY 3,1 DESC;  --先按第3列再按第1列排序（从0开始算，一般调试使用）</div></div><div><img src="SQL必知必会实践--mysql_files/Image [17].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>SELECT prod_name,prod_price FROM Products ORDER BY prod_price DESC,prod_name DESC; --降序排序，不同列名需要分别添加DESC才有效果。</div></div><div><img src="SQL必知必会实践--mysql_files/Image [18].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">ch4  过滤数据</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 9pt; color: rgb(0, 0, 0);">SELECT prod_name,prod_price FROM Products</font> <font color="#FF4635" style="font-size: 9pt;">WHERE</font> <font style="font-size: 9pt; color: rgb(0, 0, 0);">prod_price = 9.49; --匹配价格为9.49的产品</font></div></div><div><img src="SQL必知必会实践--mysql_files/Image [19].png" type="image/png" data-filename="Image.png" style="font-size: 12pt; color: rgb(65, 173, 28);"/></div><div><img src="SQL必知必会实践--mysql_files/Image [20].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>WHERE子句操作符</div><div>常用的比较操作符</div><div>不等于 &lt;&gt; 或者 ！=</div><div>不大于 !&gt;</div><div>在指定的两个值之间 BETWEEN</div><div>是NULL值 IS NULL</div><div><font color="#FF0000"><b>NULL</b></font> <font color="#FF4635">它与字段包含0、空字符串或仅仅包含空格不同</font></div><div><br/></div><div>eg.  <span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">SELECT prod_name,prod_price,vend_id FROM Products WHERE vend_id != 'BRS01<span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">';</span></span></div></div><div><img src="SQL必知必会实践--mysql_files/Image [21].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><img src="SQL必知必会实践--mysql_files/Image [22].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>SELECT cust_name,cust_email FROM Customers WHERE cust_email IS NULL;--筛选NULL值</div></div><div><img src="SQL必知必会实践--mysql_files/Image [23].png" type="image/png" data-filename="Image.png"/></div><div><img src="SQL必知必会实践--mysql_files/Image [24].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">ch5  高级数据过滤</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>SELECT prod_name,prod_price,vend_id FROM Products <font color="#FF0000">WHERE</font> vend_id = 'DLL01' <font color="#FF4635">AND</font> prod_price = 3.49;</div></div><div><img src="SQL必知必会实践--mysql_files/Image [25].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>OR操作符</div><div><span style="color: rgb(166, 0, 196);">当OR WHERE子句的第一个条件得到满足时，就不再计算第二个条件了（原文这样写，不太明白）</span></div><div>感觉取的是两个条件的并集。打印如下</div><div><img src="SQL必知必会实践--mysql_files/Image [26].png" type="image/png" data-filename="Image.png"/></div><div><img src="SQL必知必会实践--mysql_files/Image [27].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>优先级 AND &gt; OR</div><div><img src="SQL必知必会实践--mysql_files/Image [28].png" type="image/png" data-filename="Image.png"/></div><div><img src="SQL必知必会实践--mysql_files/Image [29].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>IN操作符：</div><div>优点：</div><div>清楚直观。</div><div>求值顺序便于管理，相对于AND OR来说。</div><div>执行效率比OR高。</div><div>最重要的是能够包含其他SELECT语句。</div><div><img src="SQL必知必会实践--mysql_files/Image [30].png" type="image/png" data-filename="Image.png"/> </div><div>NOT操作符，条件取反操作。</div><div>MariaDB 支持使用NOT否定IN、BETWEEN和EXISTS子句。大多数DBMS允许使用NOT否定任何条件。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>SELECT prod_name,vend_id FROM Products WHERE vend_id NOT IN ('DLL01', 'BR01') ORDER BY prod_name;</div></div><div><img src="SQL必知必会实践--mysql_files/Image [31].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">ch6  用通配符进行过滤</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><br/></div><div><span style="font-size: 10pt;">LIKE操作符--匹配搜索、复杂过滤</span></div><div><font style="font-size: 10pt;"><br/></font></div><div><span style="font-size: 10pt;">LIKE ‘</span><span style="font-size: 10pt;">%</span><span style="font-size: 10pt;">’表示任何字符出现任意次数。有些DBMS使用*表示。</span></div><div><span style="font-size: 10pt;">%可以匹配任何字符，但有一个例外，就是NULL。</span></div><div><img src="SQL必知必会实践--mysql_files/Image [32].png" type="image/png" data-filename="Image.png"/></div><div><img src="SQL必知必会实践--mysql_files/Image [33].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>LIKE ‘_’ 表示只匹配单个字符。</div><div><img src="SQL必知必会实践--mysql_files/Image [34].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>方括号[] 通配符 用来指定一个<span style="color: rgb(255, 0, 0);">字符集合。它必须匹配指定位置的一个字符。</span><span style="color: rgb(166, 0, 196);">（不生效，暂时未扎到原因）</span></div><div><img src="SQL必知必会实践--mysql_files/Image [35].png" type="image/png" data-filename="Image.png" style="font-weight: bold; color: rgb(166, 0, 196);"/></div><div><br/></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">ch7 创建计算字段</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><br/></div><div><span style="font-size: 10pt;">字段（filed）：基本上与列（column）意思相同。</span></div><div><span style="font-size: 10pt;"><span style="font-size: 10pt; color: rgb(166, 0, 196);">TRIM,RTRIM,LTRIM函数在MYSQL中无效。</span></span></div><div>下面返回元素的一个列即为计算字段。连接字符串用函数CONCAT</div><div><img src="SQL必知必会实践--mysql_files/Image [36].png" type="image/png" data-filename="Image.png"/></div><div>用AS方便命名返回后 的列名（计算字段）</div><div><img src="SQL必知必会实践--mysql_files/Image [37].png" type="image/png" data-filename="Image.png"/></div><div>执行计算命令</div><div><img src="SQL必知必会实践--mysql_files/Image [38].png" type="image/png" data-filename="Image.png"/></div><div>如何测试计算，直接用SELECT</div><div><img src="SQL必知必会实践--mysql_files/Image [39].png" type="image/png" data-filename="Image.png"/></div><div><img src="SQL必知必会实践--mysql_files/Image [40].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">ch8 使用函数处理数据</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><br/></div><div><img src="SQL必知必会实践--mysql_files/Image [41].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>#找发音相似的客户</div><div>SELECT cust_name,cust_contact FROM Customers WHERE <font color="#EB0073">SOUNDEX</font>(cust_contact)= <font color="#FF4635">SOUNDEX</font>('Michael Green');</div></div><div><img src="SQL必知必会实践--mysql_files/Image [42].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>SELECT order_num,order_date FROM Orders WHERE YEAR(order_date) = 2012;--筛选年份为2012的订单号</div></div><div><img src="SQL必知必会实践--mysql_files/Image [43].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>数字处理函数</div><div><img src="SQL必知必会实践--mysql_files/Image [44].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">ch9 汇总数据</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><br/></div><div>聚集函数：对某些行运行的函数，计算并返回一个值。</div><div>基本的一些聚集函数，计算平均值，计数，最大值，最小值，求和。</div><div>COUNT（*） 对所有行计数，包括NULL行。如果指定列名，则会忽略NULL行。</div><div>聚集函数用来汇总数据，这些函数很高效，返回结果比在客户端应用程序中计算要快的多。</div><div><img src="SQL必知必会实践--mysql_files/Image [45].png" type="image/png" data-filename="Image.png"/></div><div><img src="SQL必知必会实践--mysql_files/Image [46].png" type="image/png" data-filename="Image.png"/></div><div>指定不同价格求平均</div><div><img src="SQL必知必会实践--mysql_files/Image [47].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">ch10 分组数据</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><br/></div><div>按给定的分组返回对应组的计算字段。</div><div><img src="SQL必知必会实践--mysql_files/Image [48].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>GROUP BY子句使用注意：</div><div>a 支持嵌套，数据将在最后指定的分组上进行汇总。（建立分组时，指定的所有列都一起计算）</div><div>b 子句接收的每一列必须是检索列或是有效的表达式，不能是聚集函数。如果SELECT中使用表达式，则必须在GROUP BY子句中指定相同的表达式。</div><div>c 不允许GROUP BY列带有长度可变的数据类型（如文本或备注型字段）</div><div>d 如果分组中包含NULL值的行，则NULL作为一个分组返回。若列中有多个NULL值的行，它们将分为一组。</div><div>e GROUP BY 必须出现在WHERE子句之后，ORDER BY子句之前。</div><div><br/></div><div><span style="font-weight: bold;">WHERE过滤行，而HAVING过滤分组。（匹配）HAVING支持所有的WHERE操作符。</span></div><div><span style="font-weight: bold;">WHERE在数据</span><span style="color: rgb(255, 70, 53); font-weight: bold;">分组前</span><span style="font-weight: bold;">对数据进行过滤，而HAVING在数据</span><span style="color: rgb(255, 70, 53); font-weight: bold;">分组后</span><span style="font-weight: bold;">对数据进行过滤。</span></div><div><br/></div><div><img src="SQL必知必会实践--mysql_files/Image [49].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">ch11 子查询</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div>查询（query）任何SQL语句都是查询。但此术语一般指SELECT语句。</div><div>子查询（subquery）：SQL允许创建子查询，即嵌套在其他查询语句中的查询。<span style="font-weight: bold;">查询嵌套</span></div><div><br/></div><div>查询产品id为'RGAN01'的所有订单用户</div><div><img src="SQL必知必会实践--mysql_files/Image [50].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>注意：</div><div>a 作为子查询的SELECT语句只能查询单个列。否则报错。</div><div><img src="SQL必知必会实践--mysql_files/Image [51].png" type="image/png" data-filename="Image.png"/></div><div>b 子查询和性能：使用子查询并不总是执行这类数据检索的最有效方法。</div><div><br/></div><div>作为计算字段使用子查询--显示Customers表中每个顾客的订单总数：（注 红色部分需要两张表都在from后面才能使用，否则只能找到其中一张表）</div><div><img src="SQL必知必会实践--mysql_files/Image [52].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">ch12 联结表 --join</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div>思考：如果数据存储在多个表中，怎样用一条SELECT语句就检索出来呢？</div><div><br/></div><div>联结是一种机制，用来在一条SELECT语句中关联表，因此称为联结。</div><div><br/></div><div>关系表：</div><div>关系表的设计就是要把信息分解成多个表，一类数据一个表。各表通过某些共同的值互相关联，所以也叫关系数据库。</div><div>将数据分解为多个表能够更有效地存储，更方便地处理。</div><div><br/></div><div>创建联结：指定要联结的所有表以及关联他它们的方式即可。</div><div><img src="SQL必知必会实践--mysql_files/Image [53].png" type="image/png" data-filename="Image.png"/></div><div><img src="SQL必知必会实践--mysql_files/Image [54].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><span style="font-weight: bold;">笛卡尔积：没有联结条件（上面的where），则返回的是第一张表A和第二张表B的每一行匹配（AXB），我们称之为笛卡尔积。</span></div><div><img src="SQL必知必会实践--mysql_files/Image [55].png" type="image/png" data-filename="Image.png"/></div><div><img src="SQL必知必会实践--mysql_files/Image [56].png" type="image/png" data-filename="Image.png"/></div><div>注：笛卡尔积不是我们想要的，这里返回的数据每个供应商都匹配了每个产品，包括供应商根本没有的产品。<span style="font-weight: bold;">要保证所有联结都有正确的where语句</span>，否则DBMS将返回比你想要的数据多得多的数据。</div><div><br/></div><div>叉联结：有时返回笛卡尔积的联结，也称叉联结（cross join）<span style="color: rgb(50, 135, 18);">--暂时未涉及</span></div><div><br/></div><div>内联结：目前为止使用的联结为等值联结，它是基于两个表之间的相等测试。这种联结也称为内联结。稍微不同的语法：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>select T1col, T2col </div><div>form T1 join T2</div><div>on T1.id = T2.id</div></div><div><img src="SQL必知必会实践--mysql_files/Image [57].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>联结多个表：（注：联结的表越多，性能下降的越厉害。虽然SQL本身不限制每个联结约束中表的数目，但是实际上许多DBMS都会有限制）</div><div><img src="SQL必知必会实践--mysql_files/Image [58].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><img src="SQL必知必会实践--mysql_files/Image [59].png" type="image/png" data-filename="Image.png"/></div><div>注：上述查询的值来自3个表，没有限定，但是后面的where加了限定条件，若不加where将返回笛卡尔积。</div><div><br/></div><div><br/></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">ch13 创建高级联结</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div>使用表别名</div><div>mysql使用as（oracle中没有as），用来缩短SQL语句，允许在一条SELECT语句中多次使用相同的表</div><div><img src="SQL必知必会实践--mysql_files/Image [60].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>使用不同类型的联结</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>内联结：inner join</div><div>自联结：self join （在select语句中不止一次引用相同的表）</div><div>自然联结：natural join （标准的联结返回所有数据，相同的列甚至出现多次，自然联结排除多次出现，使每列只返回一次）</div><div>外联结：outer join （许多联结将一个表中的行与另一个表中的行相关联，但有时候需要包含没有关联行的那些行。举个例子，对每个顾客下的订单数进行技术。包括那些至今尚未下订单的顾客，列出所有产品以及订购数量，包括没有人订购的产品，计算平均销售规模，包括那些至今尚未下订单的顾客）</div></div><div><br/></div><div>自联结：（许多DBMS处理联结的效率要远高于处理子查询）</div><div><img src="SQL必知必会实践--mysql_files/Image [61].png" type="image/png" data-filename="Image.png"/></div><div><img src="SQL必知必会实践--mysql_files/Image [62].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div>自然联结：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">SELECT C.*, O.order_num, O.order_date, OI.prod_id, OI.quantity, OI.item_p</span><span style="font-family: Monaco; font-size: 9pt;">rice </span></div><div><span style="font-family: Monaco; font-size: 9pt;">FROM Customers AS C, Orders AS O, OrderItems AS OI </span></div><div><span style="font-family: Monaco; font-size: 9pt;">WHERE C.cust_id = O.cust</span><span style="font-family: Monaco; font-size: 9pt;">_id </span></div><div><span style="font-family: Monaco; font-size: 9pt;">AND OI.order_num = O.order_num </span></div><div><span style="font-family: Monaco; font-size: 9pt;">AND prod_id = 'RGAN01';</span></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><br/></div><div>+------------+---------------+---------------------+-----------+------------+----------+------------</div><div>--+--------------------+-----------------------+-----------+---------------------+---------+--------</div><div>--+------------+</div><div>| cust_id    | cust_name     | cust_address        | cust_city | cust_state | cust_zip | cust_countr</div><div>y | cust_contact       | cust_email            | order_num | order_date          | prod_id | quantit</div><div>y | item_price |</div><div>+------------+---------------+---------------------+-----------+------------+----------+------------</div><div>--+--------------------+-----------------------+-----------+---------------------+---------+--------</div><div>--+------------+</div><div>| 1000000004 | Fun4All       | 829 Riverside Drive | Phoenix   | AZ         | 88888    | USA</div><div>  | Denise L. Stephens | <a href="mailto:dstephens@fun4all.com">dstephens@fun4all.com</a> |     20007 | 2012-01-30 00:00:00 | RGAN01  |       5</div><div>0 |       4.49 |</div><div>| 1000000005 | The Toy Store | 4545 53rd Street    | Chicago   | IL         | 54545    | USA</div><div>  | Kim Howard         | NULL                  |     20008 | 2012-02-03 00:00:00 | RGAN01  |</div><div>5 |       4.99 |</div><div>+------------+---------------+---------------------+-----------+------------+----------+------------</div><div>--+--------------------+-----------------------+-----------+---------------------+---------+--------</div><div>--+------------+</div><div>2 rows in set (0.00 sec)</div></div><div><br/></div><div>外联结：</div><div>外联结一定要标明是是LEFT还是RIGHT 联结，否则报错。left表示与左边的做基准进行索引，right表示用右边的做基准进行索引，索引的那一列均不包含null这个值，其他列包括。</div><div><img src="SQL必知必会实践--mysql_files/Image [63].png" type="image/png" data-filename="Image.png"/></div><div><img src="SQL必知必会实践--mysql_files/Image [64].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">ch14 组合查询</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div>组合查询：SQL执行多个SELECT查询，并将结果作为一个查询结果集返回。这些组合查询通常称为并（union）或符合查询。</div><div>举个例子（列必须相等）</div><div><img src="SQL必知必会实践--mysql_files/Image [65].png" type="image/png" data-filename="Image.png"/></div><div>列不相等的情况</div><div><img src="SQL必知必会实践--mysql_files/Image [66].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>UNION默认会合并重复的行，若要显示所有行（包含重复的行），可以使用UNION ALL替代UNION</div><div><img src="SQL必知必会实践--mysql_files/Image [67].png" type="image/png" data-filename="Image.png"/></div><div> </div><div>对组合查询结果排序</div><div>在用UNION组合查询时，只能使用一条ORDER BY子句，它必须位于最后一条SELECT语句之后。</div><div><br/></div><div><br/></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">ch15 插入数据</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div>INSERT将行插入数据库，插入的几种方式：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>- 插入完整的行</div><div>- 插入行的一部分</div><div>- 插入某些查询结果</div></div><div><br/></div><div><img src="SQL必知必会实践--mysql_files/Image [68].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>INSERT INTO Customers(cust_id,</div><div>                      cust_name,</div><div>                      cust_address,</div><div>                      ...) -- 添加列名（字段），虽然繁琐一些，但比上述例子要安全很多，并且表结构顺序改变，也不会影响值得插入</div><div>VALUES( '1000000006',</div><div>        'Toy Land',</div><div>        '123 Any Street',</div><div>        'New York',</div><div>        'NY',</div><div>        '1111',</div><div>        'USA',</div><div>        NULL,</div><div>        NULL)</div></div><div><br/></div><div>省略列：如果表定义允许，则可以在INSERT中省略某些列，省略列必须满足以下某个条件：</div><div>a 该列定义为允许NULL值（无值或空值）</div><div>b 该表定义中给出默认值。当没有值插入时，将使用默认值。</div><div><br/></div><div>插入检索出的数据</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>INSERT Customers(cust_id,</div><div>                 cust_contact,</div><div>                 cust_email,</div><div>                 ...)</div><div>SELECT  cust_id,</div><div>        cust_contact,</div><div>        cust_email,</div><div>        ...</div><div>FROM CustNew; </div></div><div><br/></div><div>从一个表中复制另一个表</div><div><img src="SQL必知必会实践--mysql_files/Image [69].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">ch16 更新和删除数据</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>更新数据格式：</div><div>UPDATE Customers</div><div>SET cust_email = 'eamli@xx'</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">WHERE cust_id = '1000000006';</span></div></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>删除数据格式：</div><div>DELETE FROM Customers --FROM在有些DBMS中是可选的，建议使用时最好带上这个关键字，保证语句的可移植性。</div><div>WHERE cust_id= '1000000006' --不要省略WHERE语句，一不小心就会删除所有行</div></div><div><br/></div><div>DELETE语句从表中删除行，甚至是删除表中的所有行。但是，DELETE不删除表本身。</div><div><br/></div><div>更快的删除：如果想从表中删除所有行，不要使用DELETE。可使用TRUNCATE TABLE语句，它完成相同的工作，而速度更快（因为不记录数据的变动）。</div><div><br/></div><div><br/></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">ch17 创建和操纵表</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><br/></div><div>表创建基础</div><div><img src="SQL必知必会实践--mysql_files/Image [70].png" type="image/png" data-filename="Image.png"/></div><div>数据类型后面不指定NOT NULL，则默认为NULL（有些DBMS可能必须指定）</div><div><br/></div><div>主键和NULL值</div><div>主键是唯一表中某一行的列。只有不允许NULL值的列可作为主键，允许NULL值得列不能作为唯一的标识。</div><div><br/></div><div>NULL和空字符</div><div>NULL值是没有值，不是空字符串，空字符串是一个有效的值，它不是无值。NULL值用关键字NULL而不是空字符串指定。</div><div><br/></div><div>指定默认值：</div><div><img src="SQL必知必会实践--mysql_files/Image [71].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>注：默认值经常用于日期或是时间戳。例如通过引用系统日期的函数或变量，将系统日期用作默认日期。MYSQL用户指定DEFAULT CURRENT_DATE()。</div><div><br/></div><div>                        获得系统日期</div><div><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"></col><col style="width: 130px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>DBMS</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>函数或变量</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>ACCESS</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>NOW()</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>DB2</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>CURRENT_DATE</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>MySql</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>CURRENT_DATE()</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>Oracle</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>SYSDATE</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>prostgreSQL</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>CURRENT_DATE</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>SQL Server</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>GETDATE()</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>SQLite</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>date('now')</div></td></tr></tbody></table><div><br/></div></div><div>更改表ALTER TABLE</div><div>更改表的定义（理想情况下，不要再表中包含数据时对其进行更新，应该在表的设计过程中充分考虑未来的可能需求，避免今后对表的结构做大的改动）</div><div>举个例子 增加一列</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>ALTER TABLE Vendorse</div><div>ADD vend_phone CHAR(20);</div><div><br/></div><div># 删除列</div><div>ALTER TABLE Vendorse</div><div>DROP COLUMN vend_phone;</div><div><br/></div><div># 删除表</div><div>DROP TABLE custCopy</div></div><div>重命名表操作的基本语法都要求制指定新表和旧表，不同的DBMS实现存在差异。参阅DBMS文档。</div><div><br/></div><div><br/></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">ch18 使用视图</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div>视图：视图是虚拟的表，与包含数据的表不一样，视图只包含使用时动态检索数据的查询。</div><div>使用视图原因：</div><div>a 简化复杂的操作。</div><div>b 使用表的一部分而不是整个表。</div><div>c 保护数据 可以授予用户访问表的特定部分的权限，而不是整个表的访问权限。</div><div>d 更改数据格式和表示。视图可返回与底层表的表示和格式不同的数据。</div><div><br/></div><div>注：</div><div>视图必须唯一命名（不能与别的视图或是表同名）</div><div>对于可以创建的视图数目没有限制</div><div>创建视图需要足够的访问权限</div><div>视图可以嵌套（可能会严重影响性能，需要进行全面测试）</div><div>许多DBMS禁止在视图查询中使用ORDER BY子句</div><div>有些DBMS要求对返回的所有列进行命名，如果列是计算字段，则需要使用别名</div><div>视图不能索引，也不能有关联的触发器或默认值</div><div>有些DBMS把视图作为只读查询，这表示可以从视图检索数据，但不能将数据写回底层表。</div><div>有些DBMS允许创建这样的视图，它不能进行到这行不再属于视图的插入或更新。</div><div><br/></div><div>举例说明：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>SELECT cust_name, cust_contact</div><div>FROM Orderitems,Orders,Customers</div><div>WHERE customers.cust_id = orders.cust_id</div><div>AND orders.order_num = orderitems.order_num</div><div>AND prod_id = 'RGAN01';</div></div><div><br/></div><div>假如可以把整个查询包装成一个名为ProductCustomers的虚拟表，那么输入就可以简化为</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>SELECT cust_name, cust_contact</div><div>FROM ProductCustomers</div><div>WHERE prod_id = 'RGAN01';</div></div><div><br/></div><div>创建视图CREATE VIEW </div><div>与创建表一样，只能用于创建不存在的视图</div><div><br/></div><div>视图重命名</div><div>删除视图，可以使用DROP语句，其语法为DROP VIEW viewname；。覆盖（或更新）视图，必须先删除它，然后再重新创建。</div><div><br/></div><div>举个例子：</div><div><img src="SQL必知必会实践--mysql_files/Image [72].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>视图用来简化复杂的数据处理</div><div><img src="SQL必知必会实践--mysql_files/Image [73].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">ch19 使用存储过程 --无MYSQL示例，待深入研究</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><br/></div><div>存储过程：存储过程就是为以后使用而保存的一条或多条SQL语句。可以将其视为批文件，虽然它的作用不仅限于批处理。</div><div>优点：简单、安全、高性能。</div><div>缺点：可移植性差，不同DBMS种存储过程的语法有所不同。事实上，编写真正的可移植性存储过程几乎是不可能的。</div><div><br/></div><div>执行存储过程：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>EXECUTE AddNewProduct('JTS01',</div><div><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>  'Stuffed Eiffel Tower',</span></div><div><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>  6.49,</span></div><div><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>  'Plush stuffed toy with the text LaTour Fiffel in red white and bule'</span>)</div></div><div><br/></div><div>这里执行一个名为AddNewProduct的存储过程，将一个新产品添加到Products表中。</div><div>注：Products表中还有另一个需要值得列prod_id列，它是这个表的主键。为何这个值不作为属性传递给存储过程？这是为了保证恰当的生成此ID，最好是使生成此ID的过程自动化（而不是依赖于最终用户的输入）。</div><div><br/></div><div>创建存储过程：（ORACLE）</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>CREATE PROCEDURE MailingListCount(</div><div>    ListCount OUT INTEGER</div><div>)</div><div>IS</div><div>v_rows INTEGER;</div><div>BEGIN</div><div>    SELECT COUNT(*) INTO v_rows FROM Customers WHERE NOT cust_email IS NULL;</div><div>    ListCount := v_rows;</div><div>END;</div></div><div><br/></div><div><br/></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">ch20 管理事务处理</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div>事务处理：事务处理是用来管理必须成批执行的SQL操作，保证数据库不包含不完整的操作结果。利用事务处理，可以保证一组操作不会中途停止，它们要么完全执行，要么完全不执行（除非明确指示）。如果没有错误发生，整组语句提交给（写入）数据库表；如果错误发生，则进行回退（撤销），将数据库恢复到某个已知且安全的状态。</div><div><br/></div><div>使用事务处理，通过确保成批的SQL操作要么完全执行，要么完全不执行，来维护数据库的完整性。</div><div>假设数据库方式故障（如超出磁盘空间、安全限制、表锁等），导致订单插入失败，或者数据库存在不完整的订单，而你还不知道。如何解决这个问题？这就需要使用事务处理了。</div><div><br/></div><div>几个术语：</div><div>事务：只一组SQL语句</div><div>回退：指撤销指定SQL语句的过程</div><div>提交：将为存储的SQL语句结果写入数据库表</div><div>保留点：指事务处理中设置临时占位符，可以对它发布回退（与回退整个事务处理不同）</div><div><br/></div><div>事务处理用来管理INSERT UPDATE DELETE 语句。不能回退SELECT语句（没必要回退），也不能回退CREATE DROP操作。事务处理中可以使用这些语句，进行回退时，这些操作也不撤销。</div><div><br/></div><div><br/></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">ch21 使用游标</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div>简单地使用SELECT语句，没有办法得到第一个行、下一行或是前10行。这时候游标就起作用了。</div><div>游标：一个存储在DBMS服务器上的数据库查询，它不是一条SELECT语句，而是被该语句检索出来的结果集（SQL查询所检索的所有结果）</div><div>游标常见的一些选项和特性：</div><div>能够标记游标为只读，使数据能读取，但不能更新和删除。</div><div>能控制可以执行的定向操作。</div><div>能标记某些列为可编辑的，某些列为不可编辑的。</div><div>规定范围，使游标对创建它的特定请求（如存储过程）或对所有请求可访问。</div><div>指示DBMS对检索的数据进行复制，使数据在游标打开或访问期间不变化。</div><div><br/></div><div>创建游标：</div><div><img src="SQL必知必会实践--mysql_files/Image [74].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">ch22 高级SQL特性</span></div><div><span style="font-size: 12pt; color: rgb(65, 173, 28);">--</span></div><div>主键、外键、约束、索引、触发器一些概念</div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 